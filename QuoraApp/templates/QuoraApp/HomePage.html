{%  extends 'QuoraApp/main.html' %}
{% block content %}
          <div class="outer-container">
              <nav class="navbar navbar-light bg-light col-lg-2 leftbar">
                  Tags that you follow...
                    <ul class="navbar-nav">
                        {% for i in following %}
                        <li class="nav-item tag">
                            <img alt="tag" src="sampletag.jfif"/>
                            <a class="nav-link" href="{% url 'TagPage' i.tag.id %}">{{i.tag.name}}</a>
                        </li>
                        {% endfor %}

                    </ul>

              </nav>
              <div class="col-lg-6">
                <div class="card">
                  <div class="card-header headermiddle">
                    <img src="default_profile.png"/>
                    {{request.user.username}}

                  </div>
                  <div class="card-body">
                    <blockquote class="blockquote mb-0">
                      <a href="{% url 'AskQuestion' %}">What is your Question or Link?</a>
                    </blockquote>
                  </div>
                </div>
                  {% for i in answers %}
                <div class="card mt-4">
                  <div class="card-header tagmiddle">
                    <img src="Pizza.jpg"/>
                    <span>{{ i.question.askedBy.name }} asked {{ i.question.creationTime }}</span>
                    <h5 class="card-title"><a href="{% url 'Question' i.question.id %}">{{i.question.description}}</a></h5>
                    <span class="badge rounded-pill bg-warning text-dark">{{ i.question.tag }}</span>
                  </div>
                  <div class="card-body ques">
                    <p>{{ i.answeredBy }} answered {{ i.creationTime }}</p>
                    <p class="card-text">{{i.answer|safe}}</p>
                   <div class="bottommiddle" style="display:flex">

                       {% for yu in up %}
                       {% if forloop.counter0 == forloop.parentloop.counter0 %}
                       <p id="up{{i.id}}">
                       {% if yu in pres %}

                        <button type="button" disabled="true" id="disup{{i.id}}"  class="btn btn-success"><a class="upvote"    data-catid="{{ i.id }}" style="color:white" >+</a></button>

                       {% else %}

                       <button type="button"  class="btn btn-light" id="ableup{{i.id}}"><a class="upvote"  data-catid="{{ i.id }}" style="color:black;" >+</a></button>

                       {% endif %}
                           </p>
                        {% endif %}
                       {% endfor %}

                       {% for yd in down %}
                       {% if forloop.counter0 == forloop.parentloop.counter0 %}
                         <p id="dw{{i.id}}">
                       {% if yd in pres %}

                        <button type="button" disabled="true" class="btn btn-danger" id="disdw{{i.id}}"><a class="downvote"  data-catid="{{ i.id }}" style="color:white" >-</a></button>


                       {% else %}

                       <button type="button"  class="btn btn-light" id="abledw{{i.id}}"><a class="downvote"  data-catid="{{ i.id }}" style="color:black" >-</a></button>

                       {% endif %}
                              </p>
                       {% endif %}
                       {% endfor %}

                   <button type="button" class="btn btn-primary">
                       <a style="color:white;" href="{% url 'submitanswer' i.question.id %}">
                             Answer
                       </a>
                    </button>
                     </div>
                    <!-- Modal -->
                       <p>
                       {% for u in upvote %}
                       {% if forloop.counter0 == forloop.parentloop.counter0 %}
                       <span class="badge rounded-pill bg-warning text-dark">Upvotes:{{u}}</span>
                       {% endif %}
                       {% endfor %}
                       {% for k in downvote %}
                        {% if forloop.counter0 == forloop.parentloop.counter0 %}
                       <span class="badge rounded-pill bg-warning text-dark">DownVotes:{{k}}</span>
                       {% endif %}
                       {% endfor %}
                       </p>


                  </div>

                </div>
                {% endfor %}

              </div>
              <nav class="navbar navbar-light bg-light col-lg-2 rightbar">
                <ul class="navbar-nav ">
                    {% for i in tag %}
                    <li class="nav-item tag">
                      <img alt="tag" src="sampletag.jfif"/>
                        <a class="nav-link" href="{% url 'TagPage' i.id %}">{{i.name}}</a>
                    </li>
                    {% endfor %}
                </ul>

          </nav>



          </div>

{% endblock %}
{% block scripts %}

$('body').on('click','a.upvote',function(){
    var catid;
    catid = $(this).attr("data-catid");
    $.ajax(
    {
        type:"GET",
        url: "upvote/",
        data:{
                 post_id: catid
        },
        success: function( data )
        {
            console.log(data);
            $( '#up'+ catid ).empty();
            $('#up'+catid).append(
                `<button type="button" disabled="true" id="disup${catid}"  class="btn btn-success"><a class="upvote"  data-catid="${catid}" style="color:white" >+</a></button>`
            );
<!--            $('#disdw'+catid).remove();-->
<!--            $('#abledw+catid).remove();-->
                $('#dw'+catid).empty();
          $('#dw'+catid).append(
             `<button type="button"  class="btn btn-light" id="abledw${catid}"><a class="downvote"  data-catid="${catid}" style="color:black" >-</a></button>`
          );
        }
     })




});

$('body').on('click','a.downvote',function(){
    var catid;
    catid = $(this).attr("data-catid");
    $.ajax(
    {
        type:"GET",
        url: "downvote/",
        data:{
                 post_id: catid
        },
        success: function( data )
        {
            console.log(data);
             $( '#dw'+ catid ).empty();
             $('#dw'+catid).append(
                `<button type="button" disabled="true" class="btn btn-danger" id="disdw${catid}"><a class="downvote"  data-catid="${catid}" style="color:white" >-</a></button>`
            );
<!--            $('#ableup'+catid).remove();-->
<!--            $('#disup'+catid).remove();-->
            $('#up'+catid).empty();
            $('#up'+catid).append(
              `<button type="button"  class="btn btn-light" id="ableup${catid}"><a class="upvote"   data-catid="${catid}" style="color:black;" >+</a></button>`
            );
        }
     })
});






{% endblock scripts %}
